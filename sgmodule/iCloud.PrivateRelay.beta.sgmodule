#!name=ï£¿ iRingo: â˜ï¸ iCloud Private Relay Î²
#!desc=(BETA)\nå¯ç”¨å’Œè‡ªå®šä¹‰ã€ŒiCloudä¸“ç”¨ä»£ç†ã€\næ³¨:æœ¬æ¨¡å—åŒ…å«ä¸“ç”¨ä»£ç†ç›´è¿ç­–ç•¥
#!openUrl=http://boxjs.com/#/app/iRingo.PrivateRelay.beta
#!author=VirgilClyne
#!homepage=https://github.com/VirgilClyne
#!manual=https://github.com/VirgilClyne/iRingo/wiki/ğŸŒä¸“ç”¨ä»£ç†
#!icon=https://help.apple.com/assets/622BDFD810622B2B9C0BD80A/622BDFDA10622B2B9C0BD82D/zh_CN/0771d70c4da0c9d96a31bcb28bb3e3f3.png
#!system=mac
#!category=ï£¿ iRingo
#!arguments=CountryCode:US,Proxy: DIRECT
#!arguments-desc=CountryCode: å›½å®¶æˆ–åœ°åŒºä»£ç \nProxy: â˜ï¸ iCloud Private Relay åˆ†æµè§„åˆ™ä½¿ç”¨çš„ç­–ç•¥å

[Rule]
# â˜ï¸ iCloud Private Relay
# https://developer.apple.com/cn/support/prepare-your-network-for-icloud-private-relay/
# Private Relay API
USER-AGENT,Transparent%20network%20proxy%20for%20Apple%20system%20services*,{{{Proxy}}}
DOMAIN,mask-api.icloud.com,{{{Proxy}}}
DOMAIN,mask-api.fe.apple-dns.net,{{{Proxy}}}
# Optimize for Private Relay connections
RULE-SET,https://raw.githubusercontent.com/VirgilClyne/iRingo/main/RuleSet/iCloud.PrivateRelay.list,{{{Proxy}}}

[Script]
# fetchAuthTokens
â˜ï¸ iCloud.mask.fetchAuthTokens.request = type=http-request, pattern=^https?:\/\/mask-api\.icloud\.com\/v[0-9_]+\/fetchAuthTokens$, requires-body=0, debug=1, script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/beta/js/PrivateRelay.request.beta.js, argument=
â˜ï¸ iCloud.mask.fetchAuthTokens.response = type=http-response, pattern=^https?:\/\/mask-api\.icloud\.com\/v[0-9_]+\/fetchAuthTokens$, requires-body=0, debug=1, script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/beta/js/PrivateRelay.response.beta.js, argument=
# fetchConfigFile
â˜ï¸ iCloud.mask.fetchConfigFile.request = type=http-request, pattern=^https?:\/\/mask-api\.icloud\.com\/v[0-9_]+\/fetchConfigFile$, requires-body=0, debug=1, script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/beta/js/PrivateRelay.request.beta.js, argument=
â˜ï¸ iCloud.mask.fetchConfigFile.response = type=http-response, pattern=^https?:\/\/mask-api\.icloud\.com\/v[0-9_]+\/fetchConfigFile$, requires-body=1, binary-body-mode=1, debug=1, script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/beta/js/PrivateRelay.response.beta.js, argument=

[MITM]
hostname = %APPEND% mask-api.icloud.com, mask-api.fe.apple-dns.net, mask.icloud.com, mask.apple-dns.net, mask-canary.icloud.com, canary.mask.apple-dns.net, -mask-h2.icloud.com, -mask-t.apple-dns.net
